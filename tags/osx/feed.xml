<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Osx on Real Beat</title>
    <link>http://nobu666.com/tags/osx.html</link>
    <description>Recent content in Osx on Real Beat</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-JP</language>
    <copyright>&amp;copy; nobu666.com</copyright>
    <lastBuildDate>Fri, 26 Jun 2015 20:46:09 +0900</lastBuildDate>
    <atom:link href="http://nobu666.com/tags/osx/feed.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Mac OS XでパスワードやトークンをKeychain管理にしてスクリプトから使う方法</title>
      <link>http://nobu666.com/2015/06/26/1016.html</link>
      <pubDate>Fri, 26 Jun 2015 20:46:09 +0900</pubDate>
      
      <guid>http://nobu666.com/2015/06/26/1016.html</guid>
      <description>

&lt;p&gt;例えば &lt;code&gt;.zshrc&lt;/code&gt; とかに &lt;code&gt;HOMEBREW_GITHUB_API_TOKEN&lt;/code&gt; をexportしてるけど、このファイルを人に見せることになると困る。回避方法としては &lt;code&gt;~/.github_token&lt;/code&gt; を別途作ってそっちに値を書き込んで置いて&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #272822&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span style=&#34;color: #66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #f92672&#34;&gt;[&lt;/span&gt; -f ~/.github_token &lt;span style=&#34;color: #f92672&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;;&lt;/span&gt; &lt;span style=&#34;color: #66d9ef&#34;&gt;then&lt;/span&gt;
  . ~/.github_token
&lt;span style=&#34;color: #66d9ef&#34;&gt;fi&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;こんなふうにするという解決策もあるにはある。が、もうちょっとセキュアかつ簡単な方法はないものか、ということで以下のようにすると捗った&lt;/p&gt;

&lt;h2 id=&#34;keychainに値を登録する:e1867217de400bc30fb87cf008200204&#34;&gt;Keychainに値を登録する&lt;/h2&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #272822&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;security add-generic-password -a homebrew-github-api-key -s homebrew-github-api-key -w XXXXXXXXXXXXXXX
&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&#34;keychainから値をとりだす:e1867217de400bc30fb87cf008200204&#34;&gt;Keychainから値をとりだす&lt;/h2&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #272822&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;security find-generic-password -ga homebrew-github-api-key
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;このままだと余計な情報もたくさん取れてきてしまうので、必要な部分だけ抜き出すようにする&lt;/p&gt;
&lt;div class=&#34;highlight&#34; style=&#34;background: #272822&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;security find-generic-password -ga homebrew-github-api-key 2&amp;gt;&lt;span style=&#34;color: #f8f8f2&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color: #ae81ff&#34;&gt;1&lt;/span&gt; &amp;gt;/dev/null &lt;span style=&#34;color: #f8f8f2&#34;&gt;|&lt;/span&gt; ruby -e &lt;span style=&#34;color: #e6db74&#34;&gt;&amp;#39;print $1 if STDIN.gets =~ /^password: &amp;quot;(.*)&amp;quot;$/&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;これでファイルに直接書かないでよくなったので、.zshrcとかでexportするときも &lt;code&gt;$(security ...)&lt;/code&gt; をexportしてやればいい。うむ。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>